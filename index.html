<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>拍照助手</title>
    <style>
        body { padding: 20px; font-family: sans-serif; background: #f5f5f5; }
        .box { background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
        input { width: 100%; padding: 10px; margin-bottom: 10px; box-sizing: border-box; }
        .grid { display: flex; gap: 5px; }
        .pic { flex: 1; height: 100px; background: #eee; border: 1px dashed #999; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative;}
        .pic img { width: 100%; height: 100%; object-fit: cover; display: none; }
        button { width: 100%; background: #07c160; color: white; padding: 15px; border: none; border-radius: 8px; font-size: 16px; }
    </style>
</head>
<body>
    <div class="box">
        <h3>1. 输入信息</h3>
        <input type="text" id="txt" placeholder="文本内容 (如: 款号)">
        <input type="text" id="email" placeholder="收件人邮箱" value="your_boss@company.com">
    </div>
    <div class="box">
        <h3>2. 拍照 (点击方块)</h3>
        <div class="grid">
            <div class="pic" onclick="clickInput(0)"><img id="img0"><span>正</span></div>
            <div class="pic" onclick="clickInput(1)"><img id="img1"><span>侧</span></div>
            <div class="pic" onclick="clickInput(2)"><img id="img2"><span>背</span></div>
        </div>
        <input type="file" id="f0" hidden accept="image/*" onchange="read(this,0)">
        <input type="file" id="f1" hidden accept="image/*" onchange="read(this,1)">
        <input type="file" id="f2" hidden accept="image/*" onchange="read(this,2)">
    </div>
    <button onclick="upload()" id="btn">生成 PPT 并发送</button>
    <script>
        let imgs = [null, null, null];
        function clickInput(i) { document.getElementById('f'+i).click(); }
        function read(el, i) {
            let reader = new FileReader();
            reader.onload = e => {
                imgs[i] = e.target.result;
                document.getElementById('img'+i).src = e.target.result;
                document.getElementById('img'+i).style.display = 'block';
            };
            reader.readAsDataURL(el.files[0]);
        }
        async function upload() {
            if(!imgs[0] || !imgs[1] || !imgs[2]) return alert('请拍完3张照片');
            document.getElementById('btn').innerText = '正在上传处理中...';
            let res = await fetch('/upload', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({text: document.getElementById('txt').value, recipients: document.getElementById('email').value, images: imgs})
            });
            if(res.ok) alert('成功发送！');
            else alert('发送失败');
            document.getElementById('btn').innerText = '生成 PPT 并发送';
        }
    </script>
</body>
</html>